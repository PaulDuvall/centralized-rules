{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "description": "Keyword and pattern mappings for centralized-rules skill activation",
  "version": "1.3.1",
  "updated": "2025-12-21",

  "projectMarkers": {
    "description": "File markers that indicate project language/framework",
    "languages": {
      "python": {
        "files": ["pyproject.toml", "requirements.txt", "setup.py", "*.py"],
        "patterns": ["import\\s+\\w+", "from\\s+\\w+\\s+import", "def\\s+\\w+"]
      },
      "typescript": {
        "files": ["tsconfig.json", "package.json"],
        "patterns": ["interface\\s+\\w+", "type\\s+\\w+\\s*=", "import.*from"]
      },
      "javascript": {
        "files": ["package.json", "*.js"],
        "patterns": ["require\\(", "module\\.exports", "export\\s+(default|const)"]
      },
      "go": {
        "files": ["go.mod", "go.sum", "*.go"],
        "patterns": ["package\\s+\\w+", "func\\s+\\w+", "import\\s+"]
      },
      "rust": {
        "files": ["Cargo.toml", "*.rs"],
        "patterns": ["fn\\s+\\w+", "use\\s+\\w+", "impl\\s+"]
      },
      "java": {
        "files": ["pom.xml", "build.gradle", "*.java"],
        "patterns": ["public\\s+class", "import\\s+java", "package\\s+"]
      }
    },
    "frameworks": {
      "react": {
        "files": ["package.json"],
        "dependencies": ["react", "react-dom"],
        "patterns": ["useState", "useEffect", "jsx", "<.*>"]
      },
      "nextjs": {
        "files": ["next.config.js", "next.config.ts"],
        "dependencies": ["next"],
        "patterns": ["getServerSideProps", "getStaticProps"]
      },
      "fastapi": {
        "files": ["pyproject.toml", "requirements.txt"],
        "dependencies": ["fastapi"],
        "patterns": ["@app\\.get", "@app\\.post", "FastAPI\\("]
      },
      "django": {
        "files": ["manage.py", "settings.py"],
        "dependencies": ["django"],
        "patterns": ["from\\s+django", "INSTALLED_APPS"]
      },
      "flask": {
        "files": ["app.py", "wsgi.py"],
        "dependencies": ["flask"],
        "patterns": ["@app\\.route", "Flask\\(__name__\\)"]
      },
      "express": {
        "files": ["package.json"],
        "dependencies": ["express"],
        "patterns": ["app\\.get\\(", "app\\.post\\(", "require\\('express'\\)"]
      },
      "nestjs": {
        "files": ["nest-cli.json", "package.json"],
        "dependencies": ["@nestjs/core"],
        "patterns": ["@Controller", "@Injectable", "@Module"]
      }
    }
  },

  "keywordMappings": {
    "description": "Maps keywords in prompts to rule categories",
    "base": {
      "testing": {
        "keywords": ["test", "pytest", "jest", "mocha", "unittest", "spec", "tdd", "bdd", "coverage", "mock", "stub", "fixture", "vitest", "playwright", "cypress", "testcontainers", "@testing-library/react"],
        "slashCommands": ["/xtest", "/test", "/xtdd"],
        "rules": ["base/testing-philosophy"]
      },
      "security": {
        "keywords": ["auth", "authentication", "authorization", "security", "password", "token", "jwt", "oauth", "permission", "encrypt", "hash", "sanitize", "validate", "injection", "xss", "csrf", "vulnerability"],
        "slashCommands": ["/xsecurity", "/security", "/xaudit"],
        "rules": ["base/security-principles"]
      },
      "git": {
        "keywords": ["commit", "pr", "pullrequest", "merge", "branch", "git", "rebase", "cherry-pick", "push"],
        "slashCommands": ["/xgit", "/git", "/xcommit", "/commit", "/push"],
        "rules": ["base/git-workflow"],
        "description": "Detects git operations including slash commands like /xgit that perform commits/pushes"
      },
      "refactoring": {
        "keywords": ["refactor", "clean", "improve", "optimize", "simplify", "restructure", "extract", "inline", "rename"],
        "slashCommands": ["/xrefactor", "/xquality", "/xoptimize"],
        "rules": ["base/refactoring-patterns"]
      },
      "architecture": {
        "keywords": ["architect", "design", "pattern", "structure", "12-factor", "scalability", "deployment", "microservice", "monolith", "layer"],
        "rules": ["base/architecture-principles", "base/12-factor-app"]
      },
      "metrics": {
        "keywords": ["metric", "monitoring", "observability", "logging", "tracing", "alert", "dashboard", "prometheus", "grafana"],
        "rules": ["base/metrics-standards"]
      },
      "development": {
        "keywords": ["workflow", "process", "development", "ci/cd", "pipeline", "deploy"],
        "rules": ["base/development-workflow"]
      },
      "beads": {
        "keywords": ["beads", "bd", "bd-"],
        "rules": ["tools/beads/issue-tracking"]
      }
    },
    "languages": {
      "python": {
        "keywords": ["python", ".py", "pip", "pyproject", "virtualenv", "conda", "pep8", "pylint", "black", "mypy", "typehint"],
        "rules": ["languages/python"],
        "testing_rules": ["languages/python/testing"],
        "frameworks": {
          "fastapi": {
            "keywords": ["fastapi", "starlette", "pydantic", "async def", "dependencies"],
            "rules": ["frameworks/fastapi"]
          },
          "django": {
            "keywords": ["django", "model", "view", "template", "orm", "queryset"],
            "rules": ["frameworks/django"]
          },
          "flask": {
            "keywords": ["flask", "route", "blueprint", "jinja"]
          }
        }
      },
      "typescript": {
        "keywords": ["typescript", ".ts", ".tsx", "interface", "type", "generic", "decorator", "tsc"],
        "rules": ["languages/typescript"],
        "testing_rules": ["languages/typescript/testing"],
        "frameworks": {
          "react": {
            "keywords": ["react", "component", "hook", "usestate", "useeffect", "jsx", "props", "@tanstack/react-query", "useMutation", "useQuery", "useSWR", "useNavigate", "useForm", "styled-components", "tailwindcss"],
            "rules": ["frameworks/react"]
          },
          "nextjs": {
            "keywords": ["next.js", "nextjs", "getserversideprops", "getstaticprops", "app router", "pages router"]
          },
          "nestjs": {
            "keywords": ["nestjs", "controller", "service", "module", "provider", "decorator"]
          },
          "express": {
            "keywords": ["express", "middleware", "router", "req", "res"],
            "rules": ["frameworks/express"]
          }
        }
      },
      "javascript": {
        "keywords": ["javascript", ".js", "node", "npm", "yarn", "eslint"]
      },
      "go": {
        "keywords": ["go", "golang", ".go", "goroutine", "channel", "defer", "gomod"],
        "rules": ["languages/go"],
        "testing_rules": ["languages/go/testing"]
      },
      "rust": {
        "keywords": ["rust", ".rs", "cargo", "trait", "lifetime", "ownership", "borrow"],
        "rules": ["languages/rust"],
        "testing_rules": ["languages/rust/testing"]
      },
      "java": {
        "keywords": ["java", ".java", "maven", "gradle", "spring", "jvm"],
        "rules": ["languages/java"],
        "testing_rules": ["languages/java/testing"]
      }
    },
    "cloud": {
      "aws": {
        "keywords": ["aws", "lambda", "s3", "dynamodb", "cloudformation", "terraform", "cdk", "ec2", "ecs", "fargate", "apigateway"],
        "rules": ["cloud/aws"]
      },
      "azure": {
        "keywords": ["azure", "azurefunctions", "blobstorage", "cosmosdb", "armtemplate"]
      },
      "gcp": {
        "keywords": ["gcp", "cloudfunctions", "firestore", "pubsub"]
      },
      "vercel": {
        "keywords": ["vercel", "edgefunction"],
        "rules": ["cloud/vercel"]
      }
    }
  },

  "intentPatterns": {
    "description": "Regex patterns for detecting user intent",
    "patterns": [
      {
        "name": "create_test",
        "regex": "\\b(write|create|add|generate)\\s+(test|tests|unit test|integration test)\\b",
        "flags": "i",
        "rules": ["base/testing-philosophy"],
        "context_dependent": true
      },
      {
        "name": "implement_feature",
        "regex": "\\b(implement|add|create|build)\\s+(feature|functionality|endpoint|api)\\b",
        "flags": "i",
        "rules": ["base/code-quality"],
        "context_dependent": true
      },
      {
        "name": "fix_bug",
        "regex": "\\b(fix|debug|resolve|solve)\\s+(this|the|a|an)?\\s*(bug|issue|error|problem)\\b",
        "flags": "i",
        "rules": ["base/code-quality"],
        "context_dependent": true
      },
      {
        "name": "review_code",
        "regex": "\\b(review|check|analyze|audit)\\s+(code|implementation|changes)\\b",
        "flags": "i",
        "rules": ["base/code-quality"],
        "context_dependent": true
      },
      {
        "name": "refactor",
        "regex": "\\b(refactor|clean up|improve|optimize|restructure)\\b",
        "flags": "i",
        "rules": ["base/refactoring-patterns"],
        "context_dependent": false
      },
      {
        "name": "security_task",
        "regex": "\\b(secure|protect|authenticate|authorize|encrypt|validate)\\b",
        "flags": "i",
        "rules": ["base/security-principles"],
        "context_dependent": false
      },
      {
        "name": "commit_changes",
        "regex": "\\b(commit|create (pr|pull request)|merge)\\b",
        "flags": "i",
        "rules": ["base/git-workflow"],
        "context_dependent": false
      }
    ],
    "exclusions": [
      {
        "name": "test_data_not_testing",
        "regex": "\\btest\\s+(data|file|input|case|fixture)\\b",
        "flags": "i",
        "excludes_rules": ["base/testing-philosophy"],
        "description": "Prevents 'test data' or 'test file' from triggering testing rules"
      },
      {
        "name": "import_not_implement",
        "regex": "\\bimport\\s+(feature|module|library|package)\\b",
        "flags": "i",
        "excludes_rules": ["base/code-quality"],
        "description": "Prevents 'import feature' from triggering feature implementation rules"
      }
    ]
  },

  "fileContextTriggers": {
    "description": "Rules activated when working on specific file types",
    "triggers": [
      {
        "pattern": "\\.(test|spec)\\.(py|ts|js|go|rs|java)$",
        "rules": ["base/testing-philosophy"],
        "description": "Test files"
      },
      {
        "pattern": "\\.py$",
        "rules": ["languages/python"],
        "description": "Python files"
      },
      {
        "pattern": "\\.(ts|tsx)$",
        "rules": ["languages/typescript"],
        "description": "TypeScript files"
      },
      {
        "pattern": "\\.(js|jsx)$",
        "description": "JavaScript files"
      },
      {
        "pattern": "\\.go$",
        "rules": ["languages/go"],
        "description": "Go files"
      },
      {
        "pattern": "\\.rs$",
        "rules": ["languages/rust"],
        "description": "Rust files"
      },
      {
        "pattern": "\\.java$",
        "rules": ["languages/java"],
        "description": "Java files"
      },
      {
        "pattern": "Dockerfile|docker-compose\\.yml",
        "rules": ["base/12-factor-app"],
        "description": "Container files"
      },
      {
        "pattern": "terraform\\.tf|cloudformation\\.(yml|json)",
        "rules": ["cloud/aws"],
        "description": "Infrastructure as Code"
      }
    ]
  },

  "activationThresholds": {
    "description": "Thresholds for determining activation confidence",
    "minKeywordMatches": 1,
    "minPatternMatches": 0,
    "minFileContextMatches": 0,
    "confidenceLevels": {
      "high": {
        "threshold": 3,
        "description": "3+ signals (keywords/patterns/files)"
      },
      "medium": {
        "threshold": 2,
        "description": "2 signals"
      },
      "low": {
        "threshold": 1,
        "description": "1 signal"
      }
    },
    "rulePriority": {
      "description": "Priority weights for resolving conflicts when multiple rules match",
      "explicit_slash_command": 100,
      "file_context": 80,
      "intent_pattern": 60,
      "keyword_match": 40
    }
  },

  "defaultRules": {
    "description": "Always-loaded base rules",
    "rules": ["base/code-quality"]
  }
}
